echo "Fix up /product/etc/build.prop"
sed -i "/# Removed by /d" "$WORK_DIR/product/etc/build.prop" \
    && sed -i "s/#bluetooth./bluetooth./g" "$WORK_DIR/product/etc/build.prop" \
    && sed -i "s/?=/=/g" "$WORK_DIR/product/etc/build.prop" \
    && sed -i "$(sed -n "/provisioning.hostname/=" "$WORK_DIR/product/etc/build.prop" | sed "2p;d")d" "$WORK_DIR/product/etc/build.prop"

echo "Add display refresh rate props"
sed -i \
    "/max_frame_buffer_acquired_buffers/a ro.surface_flinger.enable_frame_rate_override=false\nro.surface_flinger.use_content_detection_for_refresh_rate=false" \
    "$WORK_DIR/vendor/default.prop"

BUILD_PROP="$WORK_DIR/system/system/build.prop"

# Append the properties
echo -e "\n# ADDITIONAL PROPERTIES\n####################################" >> "$BUILD_PROP"
echo "profiler.force_disable_err_rpt=1" >> "$BUILD_PROP"
echo "profiler.force_disable_ulog=1" >> "$BUILD_PROP"
echo "logcat.live=disable" >> "$BUILD_PROP"
echo "ro.ril.disable.power.collapse=1" >> "$BUILD_PROP"
echo "pm.sleep_mode=1" >> "$BUILD_PROP"
echo "windowsmgr.max_events_per_sec=60" >> "$BUILD_PROP"
echo "wifi.supplicant_scan_interval=180" >> "$BUILD_PROP"
echo "debug.force_low_ram=true" >> "$BUILD_PROP"
echo "ro.config.small_battery=true" >> "$BUILD_PROP"

echo -e "\n# Kernel & Debugging" >> "$BUILD_PROP"
echo "ro.config.kernel=0" >> "$BUILD_PROP"
echo "ro.config.alarm_alert=0" >> "$BUILD_PROP"
echo "ro.config.ringtone=0" >> "$BUILD_PROP"
echo "ro.config.notification_sound=0" >> "$BUILD_PROP"
echo "ro.config.mms_sound=0" >> "$BUILD_PROP"
echo "ro.config.cal_notification=0" >> "$BUILD_PROP"
echo "ro.config.msg_notification=0" >> "$BUILD_PROP"
echo "ro.kernel.logger=0" >> "$BUILD_PROP"
echo "ro.kernel.android.checkjni=0" >> "$BUILD_PROP"
echo "ro.kernel.checkjni=0" >> "$BUILD_PROP"

echo -e "\n# Disable unnecessary services" >> "$BUILD_PROP"
echo "ro.config.hw_fast_dormancy=1" >> "$BUILD_PROP"
echo "ro.config.hw_power_saving=1" >> "$BUILD_PROP"
echo "ro.config.hw_quickpoweron=true" >> "$BUILD_PROP"
echo "ro.config.combined_signal=true" >> "$BUILD_PROP"
echo "persist.sys.purgeable_assets=1" >> "$BUILD_PROP"
echo "persist.sys.use_dithering=0" >> "$BUILD_PROP"
echo "persist.sys.ui.hw=1" >> "$BUILD_PROP"
echo "persist.sys.strictmode.visual=0" >> "$BUILD_PROP"
echo "persist.sys.strictmode.disable=1" >> "$BUILD_PROP"

echo -e "\n# Wi-Fi & Bluetooth Logging" >> "$BUILD_PROP"
echo "wifi.supplicant_scan_interval=180" >> "$BUILD_PROP"
echo "ro.ril.disable.power.collapse=1" >> "$BUILD_PROP"
echo "pm.sleep_mode=1" >> "$BUILD_PROP"
echo "ro.ril.power_collapse=1" >> "$BUILD_PROP"
echo "persist.bluetooth.disableabsvol=true" >> "$BUILD_PROP"
echo "persist.bluetooth.disableapm=true" >> "$BUILD_PROP"
echo "persist.bluetooth.disableaptx=true" >> "$BUILD_PROP"
echo "persist.bluetooth.enable_dual_mode_audio=false" >> "$BUILD_PROP"

echo -e "\n# Samsung & Google Tracking" >> "$BUILD_PROP"
echo "ro.smps.enable=false" >> "$BUILD_PROP"
echo "ro.opa.eligible_device=false" >> "$BUILD_PROP"
echo "ro.setupwizard.mode=DISABLED" >> "$BUILD_PROP"
echo "ro.com.google.gmsversion=0" >> "$BUILD_PROP"
echo "ro.com.google.clientidbase=android-samsung" >> "$BUILD_PROP"
echo "ro.com.google.clientidbase.ms=android-samsung" >> "$BUILD_PROP"
echo "ro.com.google.clientidbase.am=android-samsung" >> "$BUILD_PROP"
echo "ro.com.google.clientidbase.yt=android-samsung" >> "$BUILD_PROP"
echo "ro.com.google.clientidbase.gmm=android-samsung" >> "$BUILD_PROP"

echo -e "\n# Samsung & Google Analytics" >> "$BUILD_PROP"
echo "ro.sem.analytics.enable=false" >> "$BUILD_PROP"
echo "ro.samsung.analytics.enable=false" >> "$BUILD_PROP"
echo "ro.smps.enable=false" >> "$BUILD_PROP"
echo "ro.error.receiver.default=com.samsung.errorreceiver" >> "$BUILD_PROP"
echo "error.receiver.default=com.samsung.errorreceiver" >> "$BUILD_PROP"
echo "ro.error.receiver.system.apps=com.samsung.errorreceiver" >> "$BUILD_PROP"
echo "error.receiver.system.apps=com.samsung.errorreceiver" >> "$BUILD_PROP"
echo "ro.config.tima=0" >> "$BUILD_PROP"
echo "ro.config.timaversion=0" >> "$BUILD_PROP"
echo "ro.fota.ops=no" >> "$BUILD_PROP"
echo "ro.security.icd.flagmode=none" >> "$BUILD_PROP"
echo "ro.security.mdpp.ux=Disabled" >> "$BUILD_PROP"
echo "ro.security.vpnpp.ver=1.4" >> "$BUILD_PROP"
echo "ro.security.vpnpp.release=5.0" >> "$BUILD_PROP"

echo -e "\n# Disable debugging and logging" >> "$BUILD_PROP"
echo "persist.debug.wfd.enable=0" >> "$BUILD_PROP"
echo "persist.sys.debug.multi_window=0" >> "$BUILD_PROP"
echo "debug.sf.hw=0" >> "$BUILD_PROP"
echo "debug.egl.profiler=0" >> "$BUILD_PROP"
echo "debug.egl.hw=0" >> "$BUILD_PROP"
echo "debug.mdpcomp.logs=0" >> "$BUILD_PROP"
echo "debug.enable.wl_log=0" >> "$BUILD_PROP"
echo "debug.qualcomm.sns.daemon=0" >> "$BUILD_PROP"
echo "debug.qualcomm.sns.hal=0" >> "$BUILD_PROP"
echo "debug.qualcomm.sns.libsensor1=0" >> "$BUILD_PROP"
echo "persist.service.lgospd.enable=0" >> "$BUILD_PROP"
echo "persist.service.pcsync.enable=0" >> "$BUILD_PROP"
echo "logcat.live=disable" >> "$BUILD_PROP"
echo "ro.kernel.android.checkjni=0" >> "$BUILD_PROP"
echo "ro.kernel.checkjni=0" >> "$BUILD_PROP"
echo "dalvik.vm.checkjni=false" >> "$BUILD_PROP"
echo "profiler.force_disable_err_rpt=1" >> "$BUILD_PROP"
echo "profiler.force_disable_ulog=1" >> "$BUILD_PROP"
echo "ro.config.htc.nocheckin=1" >> "$BUILD_PROP"
echo "ro.config.nocheckin=1" >> "$BUILD_PROP"
echo "ro.debuggable=0" >> "$BUILD_PROP"
echo "persist.sys.usb.config=mtp" >> "$BUILD_PROP"
echo "ro.secure=1" >> "$BUILD_PROP"
echo "ro.adb.secure=1" >> "$BUILD_PROP"
echo "ro.min_pointer_dur=8" >> "$BUILD_PROP"

echo -e "\n# Fake Encryption" >> "$BUILD_PROP"
echo "ro.crypto.state=encrypted" >> "$BUILD_PROP"

echo -e "\n# Fix Sheath" >> "$BUILD_PROP"
echo "ro.security.keystore.keytype=gak,sgak" >> "$BUILD_PROP"

echo "Properties have been appended to $BUILD_PROP"
